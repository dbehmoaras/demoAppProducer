const { CompressionTypes } = require('kafkajs');
const kafka = require('./kafka');
const fs = require('fs');
const { setConstantValue } = require('typescript');



class SubmitProducer{
	constructor(topic){
		this.topic = topic;
		this.producer = kafka.producer();
	}

	executeSend = async (data) => {
		try {
			console.log('execute send this data: ', data)
			await this.producer.send({
				topic : this.topic,
				messages : [
					{
						// data
						key: String('test'),
						value: String(JSON.stringify(data)),
					}
				]
			})
		}
		catch (err) {
			console.log("Error with producing in executeSend(): ", err);
		}
	}


	produce = async (time = 0, data = null) => {
		if(!data) return console.log('no data passed in')
		console.log('producerjs data: ', data)
		await this.producer.connect();
		await this.executeSend(data)

	}
}



module.exports = SubmitProducer;